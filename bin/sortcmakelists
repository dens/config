#!/usr/bin/python
import re, tempfile, os, sys

infile = sys.argv[1]
outfile = '/dev/stdout'

lst = []
inlst = False
out = open (outfile, 'w')

for line in open (infile, 'r'):
    if not inlst:
        print >> out, line,
        if re.match (r'^\s*#[^#]*@SORT@', line):
            inlst = True
    else:
        line = line.strip()
        if line.startswith (')'):
            lst.sort()
            print >> out, '  ' + '\n  '.join (lst) + '\n' + line
            lst = []
            inlst = False
        else:
            lst += [line]
